package dev._3000IQPlay.trillium.modules.exploit;

import dev._3000IQPlay.trillium.command.Command;
import dev._3000IQPlay.trillium.modules.Module;
import dev._3000IQPlay.trillium.setting.Setting;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.math.Vec3d;

public class HitBoxDesync extends Module {
    private static final double MAGIC_OFFSET = .200009968835369999878673424677777777777761;

    public Setting<Boolean> tutorial = this.register(new Setting<>("HowToUse", true));

    public HitBoxDesync() {
        super("HitBoxDesync", "Crashes Chinese crystal auras.", Category.EXPLOIT, true, false, false);
    }

    // China code
    @Override
    public void onTick() {
        if (this.tutorial.getValue()) {
            Command.sendMessage("How to use HitBoxDesync:");
            Command.sendMessage("1. Enter a 2x1 hole.");
            Command.sendMessage("2. If you're on 1.12, you need to look in +X or +Z direction.");
            Command.sendMessage("3. Crashes Chinese Crystal Auras");
        }
        if (mc.world == null) return;
        EnumFacing f = mc.player.getHorizontalFacing();
        Vec3d offset = new Vec3d(f.getDirectionVec());

        Vec3d fin = merge(new Vec3d(mc.player.getPosition()).add(0.5, 0, 0.5).add(offset.scale(MAGIC_OFFSET)), f);
        mc.player.setPosition(fin.x == 0 ? mc.player.posX : fin.x,
                mc.player.posY,
                fin.z == 0 ? mc.player.posZ : fin.z);
        disable();
    }

    private Vec3d merge(Vec3d a, EnumFacing facing) {
        return new Vec3d(a.x * Math.abs(facing.getDirectionVec().getX()), a.y * Math.abs(facing.getDirectionVec().getY()), a.z * Math.abs(facing.getDirectionVec().getZ()));
    }
}
